<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAE303</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="SAE.js"></script>
</head>
<body>
<h1>SAE 303</h1>
<canvas id="ACE"></canvas>

<script>
document.addEventListener("DOMContentLoaded", function() {
  if (typeof data === 'undefined') {
    console.error("La variable 'data' n'est pas définie dans SAE.js.");
    return;
  }

  // Filtrer les données pour exclure celles qui ne correspondent pas au format attendu
  var filteredData = data.filter(entry => entry.type === 'table' && entry.data && Array.isArray(entry.data));

  // Assurez-vous que des données filtrées sont présentes
  if (filteredData.length === 0) {
    console.error("Aucune donnée valide n'a été trouvée dans le format attendu.");
    return;
  }

  // Sélectionnez la première table de données filtrée (vous pouvez ajuster cela en fonction de votre structure)
  var tableData = filteredData[0].data;

  // Filtrez les données uniquement pour le solveur ACE (insensible à la casse) et celles inférieures à 2400
  var filteredAceData = tableData.filter(entry => entry.name && entry.name.toLowerCase() === "ace" && parseFloat(entry.time) < 2400);

  // Extraction des données pour le graphique
  var problemNames = filteredAceData.map(entry => entry.fullname);
  var times = filteredAceData.map(entry => parseFloat(entry.time));

  var ctx = document.getElementById('ACE').getContext('2d');
  var myBarChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: problemNames,
      datasets: [{
        label: 'Temps de résolution par problème (ACE)',
        data: times,
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        borderColor: 'rgba(75, 192, 192, 1)',
        borderWidth: 1,
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true,
          max: 2400,
        }
      }
    }
  });

  myBarChart.options.plugins.legend.labels.filter = function(legendItem, chartData) {
    return chartData.labels.indexOf(legendItem.text) !== -1;
  };
});


</script>

</body>
</html>
